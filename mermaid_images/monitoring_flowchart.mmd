flowchart TD
    %% 시작 노드
    Start([시작:<br/>연동 예약<br/>운영 모니터링]):::online

    %% 메인 모니터링 채널
    Cond1{채널 선택}:::online

    %% ========== 1. 국내예약실패 채널 ==========
    subgraph Channel1["슬랙 - 국내예약실패"]
        direction TB
        A1[국내예약실패<br/>채널 확인]:::online
    end

    Cond2{알럿<br/>유형}:::online

    subgraph Domestic1["연락처 오류"]
        direction TB
        B1[+82 10~<br/>형식 확인]:::online
        B2[수정 및 재예약<br/>권유 문자]:::online
    end

    subgraph Domestic2["공급사 확인"]
        direction TB
        C1[시트 기재]:::online
        C2[3.0 상태 확인]:::online
        C3[공급사 확인]:::online
    end

    %% ========== 2. 해외공통 채널 ==========
    subgraph Channel2["슬랙 - 해외공통"]
        direction TB
        D1[해외공통<br/>채널 확인]:::online
        D2[연동 결과<br/>반영 실패 검색]:::online
    end

    Cond3{몽키트래블<br/>예외 여부}:::online

    subgraph Overseas1["예외"]
        direction TB
        E1[체크 이모지만]:::online
    end

    subgraph Overseas2["취소 접수"]
        direction TB
        F1[시트 기재]:::online
        F2[3.0 확인]:::online
        F3[공급사 취소]:::online
    end

    %% ========== 3. 해외예약실패 채널 ==========
    subgraph Channel3["슬랙 - 해외예약실패"]
        direction TB
        G1[해외예약실패<br/>채널 확인]:::online
    end

    Cond4{알럿<br/>유형}:::online

    subgraph Fail1["실패 처리"]
        direction TB
        H1[시트 기재]:::online
        H2[중복 확인]:::online
    end

    Cond5{공급사<br/>선택}:::online

    subgraph Supplier1["KLOOK/BMG"]
        direction TB
        I1[KLOOK:<br/>알럿 사유]:::online
        I2[BMG:<br/>BMP 검색]:::online
    end

    subgraph Supplier2["JTR/GYG"]
        direction TB
        J1[JTR:<br/>어드민 검색]:::online
        J2[GYG:<br/>CS 문의]:::online
    end

    subgraph Supplier3["기타"]
        direction TB
        K1[티켓츠<br/>링크티비티<br/>트립닷컴]:::online
    end

    subgraph Final1["최종 처리"]
        direction TB
        L1[3.0<br/>확정/취소]:::online
        L2[여행자<br/>안내 문자]:::online
        L3[시트<br/>업데이트]:::online
    end

    %% ========== 4. GYG 쿼리 모니터링 ==========
    subgraph Channel4["리대쉬 - GYG"]
        direction TB
        M1[리대쉬<br/>Refresh]:::online
        M2[refund status<br/>공백 확인]:::online
        M3[시트 기재]:::online
        M4[Price adjusted<br/>메일 확인]:::online
        M5[ZD 중복 확인]:::online
    end

    Cond6{긴급도}:::online

    subgraph GYG1["티켓 생성"]
        direction TB
        N1[당일/전일<br/>티켓 생성]:::online
        N2[메일/문자<br/>발송]:::online
    end

    subgraph GYG2["간단 안내"]
        direction TB
        O1[3.0 처리 및<br/>문자만]:::online
    end

    %% 종료
    End([완료]):::online

    %% ========== 연결 흐름 ==========
    Start --> Cond1

    %% 1번 채널
    Cond1 -->|국내| A1
    A1 --> Cond2
    Cond2 -->|연락처| B1
    B1 --> B2
    B2 --> End
    Cond2 -->|일반| C1
    C1 --> C2
    C2 --> C3
    C3 --> End

    %% 2번 채널
    Cond1 -->|해외공통| D1
    D1 --> D2
    D2 --> Cond3
    Cond3 -->|예외| E1
    E1 --> End
    Cond3 -->|일반| F1
    F1 --> F2
    F2 --> F3
    F3 --> End

    %% 3번 채널
    Cond1 -->|해외실패| G1
    G1 --> Cond4
    Cond4 -->|자동취소| End
    Cond4 -->|일반| H1
    H1 --> H2
    H2 --> Cond5

    Cond5 -->|KLOOK/BMG| I1
    I1 --> I2
    I2 --> L1

    Cond5 -->|JTR/GYG| J1
    J1 --> J2
    J2 --> L1

    Cond5 -->|기타| K1
    K1 --> L1

    L1 --> L2
    L2 --> L3
    L3 --> End

    %% 4번 GYG 쿼리
    Cond1 -->|GYG쿼리| M1
    M1 --> M2
    M2 --> M3
    M3 --> M4
    M4 --> M5
    M5 --> Cond6

    Cond6 -->|긴급| N1
    N1 --> N2
    N2 --> End

    Cond6 -->|일반| O1
    O1 --> End

    %% 스타일
    classDef online fill:#FFF9C4,stroke:#FFD54F,stroke-width:3px,color:#000,font-size:16px
    classDef offline fill:#FFE0B2,stroke:#FFB74D,stroke-width:3px,color:#000,font-size:16px
